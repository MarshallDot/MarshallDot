version: "3.2"
services:
  api:
    build: .
    depends_on:
      - postgres
    volumes:
      - ./:/api
    ports:
      - [::1]:6006:6006
  postgres:
    build:
      context: ${PWD}
    volumes:
      - $PWD/pg-data/:/var/lib/postgresql/data
        - $PWD/python-app:/var/www/html
    ports:
      - "8008:8008"
    environment:
      - POSTGRES_USER=root
        - POSTGRES_DB=mar
        - POSTGRES_PASSWORD=example
    networks:
      node_net:
        ipv4_address: 172.28.1.4
networks:
  node_net:
    ipam:
      driver: default
      config:
        - subnet: 172.28.0.0/16